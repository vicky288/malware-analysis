"""
Scans a pe file and checks for anti-debugging method calls
"""
import pefile

pe =  pefile.PE('/z_works/test/pefile.exe', fast_load=True)
pe.parse_data_directories()
for entry in pe.DIRECTORY_ENTRY_IMPORT:
  for imp in entry.imports:
    if 'FindWindow' in imp.name :
      print 'Anti-Debug function FindWindow is Present at', hex(imp.address) 
    if 'OutputDebugString' in imp.name :
      print 'Anti-Debug function OutputDebugString is Present at', hex(imp.address)
    if 'IsDebuggerPresent' in imp.name :
      print 'Anti-Debug function IsDebuggerPresent is Present at', hex(imp.address)
    if 'CheckRemoteDebuggerPresent' in imp.name :
      print 'Anti-Debug function CheckRemoteDebuggerPresent is Present at', hex(imp.address)
